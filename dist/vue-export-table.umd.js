(function(e,i){typeof exports=="object"&&typeof module<"u"?module.exports=i(require("vue"),require("xlsx")):typeof define=="function"&&define.amd?define(["vue","xlsx"],i):(e=typeof globalThis<"u"?globalThis:e||self,e.VueExportTable=i(e.Vue,e.XLSX))})(this,function(e,i){"use strict";async function k(d,o,l){const c=(await import("jspdf")).default,p=(await import("jspdf-autotable")).default,f=new c;f.text(d||"Data",10,10),p(f,{startY:20,head:[o.map(m=>m.text)],body:l.map(m=>o.map(g=>m[g.value]))}),f.save(`${d||"data"}.pdf`)}const x=(d,o)=>{const l=d.__vccOpts||d;for(const[c,p]of o)l[c]=p;return l},_={class:"flex justify-between items-center mb-4"},E={class:"text-lg font-semibold"},w={class:"min-w-full text-sm text-gray-800"},V={class:"bg-gray-100"},N={class:"mt-4 flex justify-between items-center"},S={class:"text-sm text-gray-600"},P={class:"flex items-center gap-2"},B=["disabled"],D=["disabled"];return x({__name:"ExportTable",props:{title:String,headers:Array,items:Array,search:String,perPage:{type:Number,default:10}},setup(d){const o=d,l=e.ref(1),c=e.computed(()=>{if(!o.search)return o.items;const a=o.search.toLowerCase();return o.items.filter(r=>Object.values(r).some(t=>typeof t=="string"&&t.toLowerCase().includes(a)))}),p=e.computed(()=>Math.ceil(c.value.length/o.perPage)),f=e.computed(()=>(l.value-1)*o.perPage),m=e.computed(()=>Math.min(l.value*o.perPage,c.value.length)),g=e.computed(()=>c.value.slice(f.value,m.value));e.watch(()=>[o.search,o.items],()=>{l.value=1});function b(a,r){if(!a.sticky)return{};const t=a.stickyPosition||"left",n=t==="right"?"z-30":"z-20",s=t==="left"?y.value[r]||0:h.value.find(([u])=>u===r)?.[1]||0;return{class:`sticky bg-white ${n}`,style:`${t}: ${s}px; background: white;`}}const y=e.computed(()=>{let a=0;return!o.headers||!Array.isArray(o.headers)?[]:o.headers.map(r=>{if(r.sticky&&r.stickyPosition==="left"){const t=a;return a+=150,t}return null})}),h=e.computed(()=>{let a=0;const r=o.headers,t=[];if(!r||!Array.isArray(r))return[];for(let n=r.length-1;n>=0;n--){const s=r[n];s.sticky&&s.stickyPosition==="right"&&(t.unshift([n,a]),a+=150)}return t});function j(){l.value>1&&l.value--}function $(){l.value<p.value&&l.value++}function C(){const a=[o.headers.map(s=>s.text)];c.value.forEach(s=>{a.push(o.headers.map(u=>s[u.value]))});const r=a.map(s=>s.join(",")).join(`
`),t=new Blob([r],{type:"text/csv"}),n=document.createElement("a");n.href=URL.createObjectURL(t),n.download=`${o.title||"data"}.csv`,n.click()}function T(){const a=c.value.map(n=>Object.fromEntries(o.headers.map(s=>[s.text,n[s.value]]))),r=i.utils.json_to_sheet(a),t=i.utils.book_new();i.utils.book_append_sheet(t,r,"Sheet1"),i.writeFile(t,`${o.title||"data"}.xlsx`)}function F(){k(o.title,o.headers,c.value)}return(a,r)=>(e.openBlock(),e.createElementBlock("div",null,[e.createElementVNode("div",_,[e.createElementVNode("h2",E,e.toDisplayString(o.title),1),e.createElementVNode("div",{class:"flex gap-2"},[e.createElementVNode("button",{onClick:C,class:"btn-export bg-emerald-500"}," CSV "),e.createElementVNode("button",{onClick:T,class:"btn-export bg-indigo-500"}," Excel "),e.createElementVNode("button",{onClick:F,class:"btn-export bg-rose-500"},"PDF")])]),e.createElementVNode("div",{class:"overflow-x-auto relative rounded border",style:e.normalizeStyle({...Object.fromEntries((y.value.value||[]).map((t,n)=>[`--offset-left-${n}`,`${t}px`])),...Object.fromEntries((h.value.value||[]).map(([t,n])=>[`--offset-right-${t}`,`${n}px`]))})},[e.createElementVNode("table",w,[e.createElementVNode("thead",V,[e.createElementVNode("tr",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.headers,(t,n)=>(e.openBlock(),e.createElementBlock("th",e.mergeProps({key:t.value},{ref_for:!0},b(t,n),{class:["text-left p-2",t.class]}),e.toDisplayString(t.text),17))),128))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(g.value,(t,n)=>(e.openBlock(),e.createElementBlock("tr",{key:t.id||n,class:"odd:bg-white even:bg-gray-50 hover:bg-gray-100"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.headers,(s,u)=>(e.openBlock(),e.createElementBlock("td",e.mergeProps({key:s.value},{ref_for:!0},b(s,u),{class:["border px-2 py-1 whitespace-nowrap",s.class]}),[e.renderSlot(a.$slots,`cell-${s.value}`,{row:t},()=>[e.createTextVNode(e.toDisplayString(t[s.value]),1)],!0)],16))),128))]))),128))])])],4),e.createElementVNode("div",N,[e.createElementVNode("div",S," Menampilkan "+e.toDisplayString(f.value+1)+"â€“"+e.toDisplayString(m.value)+" dari "+e.toDisplayString(c.value.length),1),e.createElementVNode("div",P,[e.createElementVNode("button",{onClick:j,disabled:l.value===1,class:"btn-nav"}," < ",8,B),e.createElementVNode("span",null,"Hal. "+e.toDisplayString(l.value)+" / "+e.toDisplayString(p.value),1),e.createElementVNode("button",{onClick:$,disabled:l.value===p.value,class:"btn-nav"}," > ",8,D)])])]))}},[["__scopeId","data-v-8b5fd7bc"]])});
