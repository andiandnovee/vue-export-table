(function(e,c){typeof exports=="object"&&typeof module<"u"?module.exports=c(require("vue"),require("xlsx"),require("jspdf"),require("jspdf-autotable")):typeof define=="function"&&define.amd?define(["vue","xlsx","jspdf","jspdf-autotable"],c):(e=typeof globalThis<"u"?globalThis:e||self,e.VueExportTable=c(e.Vue,e.XLSX,e.jsPDF,e.autoTable))})(this,function(e,c,f,b){"use strict";const h=(p,t)=>{const a=p.__vccOpts||p;for(const[r,d]of t)a[r]=d;return a},_={class:"flex justify-between items-center mb-4"},x={class:"text-lg font-semibold"},g={class:"overflow-x-auto rounded border"},E={class:"min-w-full text-sm text-gray-800"},k={class:"bg-gray-100"},y={class:"text-xs italic text-gray-400"},V={class:"mt-4 flex justify-between items-center"},N={class:"text-sm text-gray-600"},w={class:"flex items-center gap-2"},B=["disabled"],S=["disabled"];return h({__name:"ExportTable",props:{title:String,headers:Array,items:Array,search:String,perPage:{type:Number,default:10}},setup(p){const t=p,a=e.ref(1),r=e.computed(()=>{if(!t.search)return t.items;const n=t.search.toLowerCase();return t.items.filter(l=>Object.values(l).some(o=>typeof o=="string"&&o.toLowerCase().includes(n)))});console.log("✅ headers:",t.headers),console.log("✅ items:",t.items);const d=e.computed(()=>Math.ceil(r.value.length/t.perPage)),m=e.computed(()=>(a.value-1)*t.perPage),u=e.computed(()=>Math.min(a.value*t.perPage,r.value.length)),j=e.computed(()=>r.value.slice(m.value,u.value));e.watch(()=>[t.search,t.items],()=>{a.value=1});function D(){a.value>1&&a.value--}function P(){a.value<d.value&&a.value++}function C(){const n=[t.headers.map(s=>s.text)];r.value.forEach(s=>{n.push(t.headers.map(T=>s[T.value]))});const l=n.map(s=>s.join(",")).join(`
`),o=new Blob([l],{type:"text/csv"}),i=document.createElement("a");i.href=URL.createObjectURL(o),i.download=`${t.title||"data"}.csv`,i.click()}function L(){const n=r.value.map(i=>Object.fromEntries(t.headers.map(s=>[s.text,i[s.value]]))),l=c.utils.json_to_sheet(n),o=c.utils.book_new();c.utils.book_append_sheet(o,l,"Sheet1"),c.writeFile(o,`${t.title||"data"}.xlsx`)}function F(){const n=new f;n.text(t.title||"Data",10,10),b(n,{startY:20,head:[t.headers.map(l=>l.text)],body:r.value.map(l=>t.headers.map(o=>l[o.value]))}),n.save(`${t.title||"data"}.pdf`)}return(n,l)=>(e.openBlock(),e.createElementBlock("div",null,[e.createElementVNode("div",_,[e.createElementVNode("h2",x,e.toDisplayString(t.title),1),e.createElementVNode("div",{class:"flex gap-2"},[e.createElementVNode("button",{onClick:C,class:"btn-export bg-emerald-500"},"CSV"),e.createElementVNode("button",{onClick:L,class:"btn-export bg-indigo-500"},"Excel"),e.createElementVNode("button",{onClick:F,class:"btn-export bg-rose-500"},"PDF")])]),e.createElementVNode("div",g,[e.createElementVNode("table",E,[e.createElementVNode("thead",k,[e.createElementVNode("tr",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.headers,o=>(e.openBlock(),e.createElementBlock("th",{key:o.value,class:"text-left p-2"},e.toDisplayString(o.text),1))),128))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(j.value,(o,i)=>(e.openBlock(),e.createElementBlock("tr",{key:o.id||i},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.headers,s=>(e.openBlock(),e.createElementBlock("td",{key:s.value,class:"border-t p-2"},[e.renderSlot(n.$slots,`cell-${s.value}`,{row:o},()=>[e.createElementVNode("span",y,"("+e.toDisplayString(s.value)+")",1)],!0)]))),128))]))),128))])])]),e.createElementVNode("div",V,[e.createElementVNode("div",N," Menampilkan "+e.toDisplayString(m.value+1)+"–"+e.toDisplayString(u.value)+" dari "+e.toDisplayString(r.value.length),1),e.createElementVNode("div",w,[e.createElementVNode("button",{onClick:D,disabled:a.value===1,class:"btn-nav"},"<",8,B),e.createElementVNode("span",null,"Hal. "+e.toDisplayString(a.value)+" / "+e.toDisplayString(d.value),1),e.createElementVNode("button",{onClick:P,disabled:a.value===d.value,class:"btn-nav"},">",8,S)])])]))}},[["__scopeId","data-v-71cb5f16"]])});
