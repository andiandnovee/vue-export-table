(function(e,s){typeof exports=="object"&&typeof module<"u"?module.exports=s(require("vue"),require("xlsx")):typeof define=="function"&&define.amd?define(["vue","xlsx"],s):(e=typeof globalThis<"u"?globalThis:e||self,e.VueExportTable=s(e.Vue,e.XLSX))})(this,function(e,s){"use strict";async function b(r,t,o){const l=(await import("jspdf")).default,i=(await import("jspdf-autotable")).default,p=new l;p.text(r||"Data",10,10),i(p,{startY:20,head:[t.map(m=>m.text)],body:o.map(m=>t.map(f=>m[f.value]))}),p.save(`${r||"data"}.pdf`)}const h=(r,t)=>{const o=r.__vccOpts||r;for(const[l,i]of t)o[l]=i;return o},_={class:"flex justify-between items-center mb-4"},g={class:"text-lg font-semibold"},x={class:"overflow-x-auto rounded border"},E={class:"min-w-full text-sm text-gray-800"},k={class:"bg-gray-100"},y={class:"text-xs italic text-gray-400"},V={class:"mt-4 flex justify-between items-center"},w={class:"text-sm text-gray-600"},N={class:"flex items-center gap-2"},B=["disabled"],S=["disabled"];return h({__name:"ExportTable",props:{title:String,headers:Array,items:Array,search:String,perPage:{type:Number,default:10}},setup(r){const t=r,o=e.ref(1),l=e.computed(()=>{if(!t.search)return t.items;const c=t.search.toLowerCase();return t.items.filter(u=>Object.values(u).some(n=>typeof n=="string"&&n.toLowerCase().includes(c)))});console.log("✅ headers:",t.headers),console.log("✅ items:",t.items);const i=e.computed(()=>Math.ceil(l.value.length/t.perPage)),p=e.computed(()=>(o.value-1)*t.perPage),m=e.computed(()=>Math.min(o.value*t.perPage,l.value.length)),f=e.computed(()=>l.value.slice(p.value,m.value));e.watch(()=>[t.search,t.items],()=>{o.value=1});function D(){o.value>1&&o.value--}function P(){o.value<i.value&&o.value++}function j(){const c=[t.headers.map(a=>a.text)];l.value.forEach(a=>{c.push(t.headers.map(L=>a[L.value]))});const u=c.map(a=>a.join(",")).join(`
`),n=new Blob([u],{type:"text/csv"}),d=document.createElement("a");d.href=URL.createObjectURL(n),d.download=`${t.title||"data"}.csv`,d.click()}function C(){const c=l.value.map(d=>Object.fromEntries(t.headers.map(a=>[a.text,d[a.value]]))),u=s.utils.json_to_sheet(c),n=s.utils.book_new();s.utils.book_append_sheet(n,u,"Sheet1"),s.writeFile(n,`${t.title||"data"}.xlsx`)}function F(){b(t.title,t.headers,l.value)}return(c,u)=>(e.openBlock(),e.createElementBlock("div",null,[e.createElementVNode("div",_,[e.createElementVNode("h2",g,e.toDisplayString(t.title),1),e.createElementVNode("div",{class:"flex gap-2"},[e.createElementVNode("button",{onClick:j,class:"btn-export bg-emerald-500"},"CSV"),e.createElementVNode("button",{onClick:C,class:"btn-export bg-indigo-500"},"Excel"),e.createElementVNode("button",{onClick:F,class:"btn-export bg-rose-500"},"PDF")])]),e.createElementVNode("div",x,[e.createElementVNode("table",E,[e.createElementVNode("thead",k,[e.createElementVNode("tr",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.headers,n=>(e.openBlock(),e.createElementBlock("th",{key:n.value,class:"text-left p-2"},e.toDisplayString(n.text),1))),128))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(f.value,(n,d)=>(e.openBlock(),e.createElementBlock("tr",{key:n.id||d},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.headers,a=>(e.openBlock(),e.createElementBlock("td",{key:a.value,class:"border-t p-2"},[e.renderSlot(c.$slots,`cell-${a.value}`,{row:n},()=>[e.createElementVNode("span",y,"("+e.toDisplayString(a.value)+")",1)],!0)]))),128))]))),128))])])]),e.createElementVNode("div",V,[e.createElementVNode("div",w," Menampilkan "+e.toDisplayString(p.value+1)+"–"+e.toDisplayString(m.value)+" dari "+e.toDisplayString(l.value.length),1),e.createElementVNode("div",N,[e.createElementVNode("button",{onClick:D,disabled:o.value===1,class:"btn-nav"},"<",8,B),e.createElementVNode("span",null,"Hal. "+e.toDisplayString(o.value)+" / "+e.toDisplayString(i.value),1),e.createElementVNode("button",{onClick:P,disabled:o.value===i.value,class:"btn-nav"},">",8,S)])])]))}},[["__scopeId","data-v-805c95d7"]])});
